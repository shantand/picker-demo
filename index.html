<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Google Picker Demo</title>
</head>
<body>

  <h2>Google Drive Picker Demo</h2>

  <!-- Button the script will attach to -->
  <button id="auth-btn">Sign in & Pick a File</button>
  <div id="result" style="margin-top:20px; font-size:18px;"></div>
<script src="https://accounts.google.com/gsi/client"></script>
<script src="https://apis.google.com/js/api.js"></script>
<script>
  const CLIENT_ID = "";
  const API_KEY = "";
  const SCOPES = "https://www.googleapis.com/auth/drive.readonly";
  let oauthToken;

  function createPicker() {
    const view = new google.picker.DocsView(google.picker.ViewId.DOCS)
      .setIncludeFolders(true)
      .setSelectFolderEnabled(true);

    const picker = new google.picker.PickerBuilder()
      .setDeveloperKey(API_KEY)
      .setOAuthToken(oauthToken)
      .addView(view)
      .setCallback(pickerCallback)
      .build();
    picker.setVisible(true);
  }
  function pickerCallback(data) {
    if (data.action === google.picker.Action.PICKED) {
      const file = data.docs[0];

      const html = `
            <h3>Selected File:</h3>
            <p><strong>Name:</strong> ${file.name}</p>
            <p><strong>ID:</strong> ${file.id}</p>
            <p><strong>Type:</strong> ${file.type}</p>
          `;

          document.getElementById("result").innerHTML = html;
      }
  }

  const tokenClient = google.accounts.oauth2.initTokenClient({
    client_id: CLIENT_ID,
    scope: SCOPES,
    callback: (tokenResponse) => {
      oauthToken = tokenResponse.access_token;
      createPicker();
    }
  });

  window.onload = () => {
    gapi.load("picker", () => console.log("Picker loaded"));
    document.getElementById("auth-btn").onclick = () => {
      tokenClient.requestAccessToken();
    };
  };
</script>
</body>
</html>
